require.config({urlArgs:"v\x3d"+(new Date).getTime(),paths:{jquery:"../libs/jquery-1.9.1.min",common:"../libs/common",WebUploader:"../libs/webuploader/webuploader.min",easyForm:"../libs/jquery.easyForm",verify:"../libs/validate/jquery.validate-1.13.1.min",verify_cn:"../libs/validate/jquery_validate_extend_cn",Modal:"../libs/jquery.easyModal",loading:"../libs/jquery.loading"},shim:{easyForm:["jquery"],verify:["jquery"],verify_cn:{deps:["verify"],exports:"verify_cn"},Modal:["jquery"],loading:["jquery"]}});require("jquery common WebUploader easyForm verify verify_cn Modal loading".split(" "),function(a,e,m){function k(){c=m.create({swf:"http://cdn.bootcss.com/webuploader/0.1.1/Uploader.swf",server:"?c\x3dvideo\x26m\x3dupload",pick:{id:".upload-btn",multiple:!1},fileVal:"video",auto:!0,fileNumLimit:3,duplicate:!0,fileSingleSizeLimit:524288E3,accept:{title:"Video",extensions:"mp4",mimeTypes:"video/mp4,"}});c.on("error",function(a){console.log(a);"Q_TYPE_DENIED"==a&&e.msgModal("alert","\u9519\u8bef","\u6587\u4ef6\u683c\u5f0f\u9519\u8bef");"F_EXCEED_SIZE"==a&&e.msgModal("alert","\u9519\u8bef","\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc7\u9650\u5236")});c.on("startUpload",function(){a(".item.bg").loading("show",{bgColor:"rgba(0,0,0,0.12)",img:g+"loading1.gif"})});c.on("uploadComplete",function(){a(".item.bg").loading("hide")});c.on("uploadSuccess",function(l,b){if("200"==b.error){var d=a(l.source._refer).closest(".item");d.addClass("bg");d.find(".c-info\x3ep").html('\u5f53\u524d\u6587\u4ef6\uff1a\x3cspan class\x3d"file-name"\x3e'+b.data.filename+"\x3c/span\x3e");d.find("input[data-key\x3d'video']").val(b.data.url);d.find("input[data-key\x3d'name']").val(b.data.name);d.find("input[data-key\x3d'time']").val(b.data.time);e.msgModal("success","\u6210\u529f",b.message)}else e.msgModal("alert","\u9519\u8bef",b.message)});c.on("uploadError",function(a,b){e.msgModal("alert","\u9519\u8bef","\u4e0a\u4f20\u5931\u8d25")})}var c=null;jQuery.validator.addMethod("verifyList",function(l,b,d){var c=0;a("input[data-key\x3d'video']").each(function(){""==a(this).val()&&c++});return 1>c},a.validator.format("\u8fd8\u6709\u76ee\u5f55\u672a\u586b\u5199\u5b8c\u6574"));var h=null,f=0,g="";a(function(){g=a("#imgSrc").val();a(".file").easyForm("file");k();a("form").validate({onfocusout:!1,onkeyup:!1,onclick:!1,ignore:"",rules:{title:"required",desc:{required:!0,minlength:20},poster:"required",list:"verifyList"},errorPlacement:function(a,b){a.appendTo(b.closest(".input"))}});a(".c-list").on("click","a[data-title]",function(){h=a(this).closest(".item");a(".edit-title input").val(h.find(".title").text());a(".edit-title").fadeIn("fast")});a(".edit-title").Modal({ok:function(c){var b=c.find("input");if(""==a.trim(b.val()))return b.focus(),!1;h.find("input[data-key\x3d'title']").val(b.val());h.find(".title").text(b.val());c.fadeOut("fast")}});a(".add-link").click(function(){a(".new-course").fadeIn("fast")});a(".new-course").Modal({ok:function(c){var b=c.find("input");if(""==a.trim(b.val()))return b.focus(),!1;f++;var d=a('\x3cdiv class\x3d"item"\x3e\x3cdiv\x3e\x3cp class\x3d"title"\x3e'+b.val()+'\x3c/p\x3e\x3ca data-title\x3d"" href\x3d"javascript:;" class\x3d"c-main"\x3e\x3cimg src\x3d"'+g+'icon/edit.png"/\x3e\u7f16\u8f91\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"c-info"\x3e\x3cp\x3e\u5f53\u524d\u6587\u4ef6\uff1a\x3cspan class\x3d"file-name"\x3e\u672a\u4e0a\u4f20\x3c/span\x3e\x3c/p\x3e\x3cdiv class\x3d"upload-btn c-main"\x3e\x3cimg src\x3d"'+g+'icon/upload.png"/\x3e\u4e0a\u4f20\u89c6\u9891\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e\x3cinput type\x3d"hidden" data-key\x3d"title" name\x3d"new_link['+f+'][title]" value\x3d"'+b.val()+'" /\x3e\x3cinput type\x3d"hidden" data-key\x3d"name" name\x3d"new_link['+f+'][name]" value\x3d"" /\x3e\x3cinput type\x3d"hidden" data-key\x3d"video" name\x3d"new_link['+f+'][video]" value\x3d"" /\x3e\x3cinput type\x3d"hidden" data-key\x3d"time" name\x3d"new_link['+f+'][time]" value\x3d"" /\x3e\x3c/div\x3e');a(".c-list").append(d);b.val("");c.fadeOut("fast");k()}})})});